// Full source code provided previously.
